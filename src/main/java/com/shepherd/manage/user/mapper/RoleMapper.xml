<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.shepherd.manage.user.mapper.RoleMapper">

    <insert id="addRole">
        insert into T_MB_ROLE
    </insert>
    <insert id="batchAddRole">
        INSERT INTO T_MB_ROLE(role_name,role_name_zh,role_desc,status)
        VALUES
        <foreach collection="list" item="item" separator=",">
            (
            #{item.roleName},
            #{item.roleNameZh},
            #{item.roleDesc},
            #{item.status}
            )
        </foreach>
    </insert>
    <resultMap id="roleMenuList" type="com.shepherd.manage.user.bean.MbMenuBean">
        <id column="menu_id" property="menuId" jdbcType="INTEGER"/>
        <result column="menu_path" property="menuPath" jdbcType="VARCHAR"/>
        <result column="menu_name" property="menuName" jdbcType="VARCHAR"/>
        <result column="menu_icon" property="menuIcon" jdbcType="VARCHAR"/>
        <collection property="childs" ofType="com.shepherd.manage.user.bean.MbMenuBean" select="selectById" column="menu_id"/>

    </resultMap>
    <select id="selectById" resultMap="roleMenuList">
		select menu_id,menu_path,menu_name,menu_icon from T_MB_MENU where parent_id = #{menu_id} and is_del=0
	</select>
    <select id="roleMenuList" resultMap="roleMenuList">
        SELECT
            distinct
            m.menu_id,
            m.menu_path,
            m.menu_name,
            m.menu_icon
        FROM
            T_MB_MENU m,
            T_MB_ROLE_MENU rm
        WHERE
            m.menu_id = rm.menu_id
            AND m.parent_id = 0
            AND m.is_del =0
            AND rm.is_del=0
            AND rm.role_id in
            <foreach collection="list" item="item" open="(" close=")" separator=",">
                #{item.roleId}
            </foreach>
    </select>
</mapper>
